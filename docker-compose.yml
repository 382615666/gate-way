version: '2.0'
services:
  gateway:
    image: docker.hnjing.com:5000/xxxx/gateway:1.1.10
    volumes:
      - ./src:/src
      - ./conf/nginx.conf:/usr/local/openresty/nginx/conf/nginx.conf
    ports:
      - "8081:80"
    environment:
      # - REDIS_HOST=redis
      # - REDIS_PORT=6379
      # - REDIS_HOST=192.168.150.125
      # - REDIS_PORT=6380
      # - STATIC_FILE=url=/&path=/src/test/&h5
      - STATIC_FILE=url=/&path=/src/test/
      - NGINX_ENV=development
      # - APP_NAME=xxx
      # - PROXY=xxx_v1?real=192.168.154.40:8011,xx_v1
      # - AUTH=xxx|xxx_v1=192.168.154.40:8011,include=xxx_v1&xxx_v1
      # - API_STATISTICS=xxx_v1=192.168.154.40:8011
      - REDIS_HOST=192.168.151.178
      - REDIS_PORT=6379
      - APP_NAME=os
      - PROXY=test_v1?real=192.168.192.73:8082&path=/&location=/test/v1/,xxx_v1?real=192.168.151.178:8020,xx_v1?real=192.168.151.178:8000
      #### xxx
      # - AUTH=xx|us_v1=192.168.150.41:8008,os_v1=192.168.150.41:8000,include=os_v1&saas_portal_v1
      #### xxx
      # - AUTH=xx|paas_ability_us_v1=192.168.151.178:8020,paas_ability_os_v1=192.168.151.178:8000,include=xxx_v1&xxx_v1
      # - PROXY=xx_v1?real=192.168.150.182:8306,test_v1?real=192.168.192.73:8082&path=/&location=/test/v1/
      #### xxx
      # - AUTH=xxx|emp_os_v1=192.168.150.182:8306,include=emp_os_v1
      # - PROXY=xxxx_v1?real=192.168.151.180:8082
      #### xxx
      # - AUTH=xxx|xx_v1=192.168.151.180:8082,include=xxx_v1
      # - SERVICES=xxx_v1?real=192.168.150.40:8083,ps_v1?real=192.168.150.40:8085,crm_v1?real=192.168.150.41:8001,us_v1?real=192.168.150.41:8008,msg_v1?real=192.168.150.41:8009,cu_v1?real=192.168.150.41:8006,os_v1?real=192.168.150.41:8000,platform_v1?real=192.168.150.41:8003,portal_v1?real=192.168.150.41:8004,cp_v1?real=192.168.150.41:8002,sp_v1?real=192.168.150.41:8005,bigdata_v1?real=192.168.150.125:9088&path=/,cs_v1?real=192.168.150.105:9877&body_size=10m,wo_v1?real=192.168.150.41:8007,saas_openapi_v1?real=192.168.150.41:8011,cums_v1?real=192.168.50.125:80,order_v1?real=192.168.150.40:8077,mall_v1?real=192.168.150.40:8088,kms_v1?real=192.168.50.124:3080,trace_v2?real=192.168.50.124:3009,marketing_v2?real=192.168.50.124:3020,bicheck_v2?real=192.168.150.125:9089,tag_v1?real=192.168.150.40:8097,h5_v1?real=192.168.135.219:5858&path=/&location=/h5/,bifinance_v1?real=192.168.150.125:9090,cces_v1?real=192.168.50.125:8082,biopen_v1?real=192.168.150.125:8082,frontmall_v1?path=/&location=/&auth=false&real=192.168.150.40:8099
      #### xx
      - AUTH=xx|key=std,login_url=192.168.151.112:8911@/saas-ability-operation/v1/gateway/login,api_url=192.168.151.112:8911@/saas-ability-operation/v1/gateway/permission,permission_url=192.168.151.112:8911@/saas-ability-operation/v1/gateway/user/%s/apis,include=us_v1&os_v1&paas_ability_os_v1
    container_name: gateway
    restart: always
    hostname: gateway
    networks:
      - test
  redis:
    image: redis:alpine
    ports:
      - 6379:6379
    container_name: redis
    restart: always
    hostname: redis
    networks:
      - test      
networks:
  test:
    driver: bridge
